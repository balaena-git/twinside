<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>TwinSide ‚Äî –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- FAVICONS -->
  <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icons/apple-touch-icon.png">
  <link rel="mask-icon" href="assets/icons/logo.svg" color="#7F3DF4">
  <meta name="theme-color" content="#0B0B0D">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://twinside.com/">
  <meta property="og:title" content="TwinSide ‚Äî –∑–∞–∫—Ä—ã—Ç–∞—è —Å–æ—Ü—Å–µ—Ç—å –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö">
  <meta property="og:description" content="–ü—Ä–∏–≤–∞—Ç–Ω–æ–µ –∫–æ–º—å—é–Ω–∏—Ç–∏, –≥–¥–µ —Å—Ç–∏–ª—å, —Å—Ç—Ä–∞—Å—Ç—å –∏ –¥–æ–≤–µ—Ä–∏–µ —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è. –¢–æ–ª—å–∫–æ 18+, —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –ª—é–¥–∏.">
  <meta property="og:image" content="https://twinside.com/assets/preview.jpg">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://twinside.com/">
  <meta name="twitter:title" content="TwinSide ‚Äî –∑–∞–∫—Ä—ã—Ç–∞—è —Å–æ—Ü—Å–µ—Ç—å –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö">
  <meta name="twitter:description" content="–ü—Ä–∏–≤–∞—Ç–Ω–∞—è —Å–µ—Ç—å, –≥–¥–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å—Ç–∏–ª—å, –¥–æ–≤–µ—Ä–∏–µ –∏ —Å—Ç—Ä–∞—Å—Ç—å. –¢–æ–ª—å–∫–æ 18+.">
  <meta name="twitter:image" content="https://twinside.com/assets/preview.jpg">

  <style>
    :root {
      --gold:#F2C94C;--violet:#7F3DF4;--black:#0B0B0D;
      --carbon:#141418;--text-hi:#fff;--text-med:#CFCFE2;
    }
    *{box-sizing:border-box;}

    /* ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
    body{
      margin:0;
      font-family:"Inter",sans-serif;
      background:var(--black);
      color:var(--text-hi);
    }
    .page-wrapper {
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }
    main {
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    body::before{
      content:"";
      position:fixed;inset:0;
      background:url("https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=1600&q=80") no-repeat center/cover;
      filter:brightness(.35) blur(3px);
      z-index:-2;
    }
    body::after{
      content:"";
      position:fixed;inset:0;
      background:linear-gradient(180deg,rgba(11,11,13,.6)0%,rgba(11,11,13,.95)100%);
      z-index:-1;
    }

    .auth-box{
      background:var(--carbon);
      padding:30px;
      border-radius:12px;
      width:100%;
      max-width:380px;
      box-shadow:0 0 24px rgba(127,61,244,.25);
      animation:fadeUp .6s ease;
    }
    h1{text-align:center;color:var(--gold);font-size:26px;margin-bottom:20px;}
    .tabs{display:flex;margin-bottom:20px;border-bottom:1px solid rgba(255,255,255,.1);}
    .tabs button{
      flex:1;background:transparent;border:none;color:var(--text-med);
      padding:12px;font-weight:600;cursor:pointer;transition:.25s;
    }
    .tabs button.active{color:var(--gold);border-bottom:2px solid var(--gold);}
    form{display:none;}
    form.active{display:block;}
    input,select,datalist{
      width:100%;padding:12px;margin-bottom:14px;border-radius:8px;
      border:1px solid #1C1C22;background:var(--black);color:var(--text-hi);
    }
    input:focus,select:focus{
      outline:none;border-color:var(--violet);
      box-shadow:0 0 8px rgba(127,61,244,.5);
    }
    .checkboxes{font-size:13px;color:var(--text-med);margin-bottom:12px;}
    .checkboxes label{display:flex;align-items:center;gap:6px;margin-bottom:6px;cursor:pointer;}
    .checkboxes input[type=checkbox]{accent-color:var(--violet);}
    button.submit{
      width:100%;padding:12px;border:none;border-radius:20px;font-weight:600;
      background:var(--gold);color:var(--black);cursor:pointer;transition:.25s;
      box-shadow:0 0 18px rgba(242,201,76,.35);
    }
    button.submit:disabled{opacity:.5;cursor:not-allowed;}
    button.submit:hover:not(:disabled){filter:brightness(1.08);transform:translateY(-2px);}
    .extra{text-align:center;margin-top:12px;font-size:14px;color:var(--text-med);}
    .extra a{color:var(--violet);text-decoration:none;}
    @keyframes fadeUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
    .pair-ages{display:none;gap:8px;}
    .pair-ages.active{display:flex;}

    /* === –º–æ–¥–∞–ª–∫–∞ 18+ === */
    .age-modal{
      position:fixed;inset:0;background:rgba(0,0,0,.9);
      display:flex;align-items:center;justify-content:center;z-index:999;
    }
    .age-content{
      background:var(--carbon);padding:30px;border-radius:12px;text-align:center;
      max-width:360px;box-shadow:0 0 24px rgba(127,61,244,.4);
    }
    .age-content h2{color:var(--gold);margin-bottom:10px;}
    .age-content p{color:var(--text-med);margin-bottom:20px;}
    .age-content button{
      padding:10px 24px;margin:0 6px;border:none;border-radius:20px;font-weight:600;
      cursor:pointer;transition:.2s;
    }
    .age-yes{background:var(--gold);color:var(--black);}
    .age-no{background:#2c2c2c;color:#fff;}
    .age-content button:hover{transform:translateY(-2px);}
  </style>
</head>

<body>
  <div class="page-wrapper">
    <main>
      <div class="auth-box">
        <!-- –º–æ–¥–∞–ª–∫–∞ 18+ -->
        <div class="age-modal" id="ageModal">
          <div class="age-content">
            <h2>–í–∞–º –µ—Å—Ç—å 18 –ª–µ—Ç?</h2>
            <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ TwinSide –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
            <button class="age-yes" id="yesBtn">–î–∞, –º–Ω–µ 18+</button>
            <button class="age-no" id="noBtn">–ù–µ—Ç</button>
          </div>
        </div>

        <div class="auth-box" id="authBox" style="display:none;">
          <h1>üë• TwinSide</h1>

          <div class="tabs">
            <button id="tab-login" class="active">–í—Ö–æ–¥</button>
            <button id="tab-register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
          </div>

          <!-- –≤—Ö–æ–¥ -->
          <form id="login-form" class="active">
            <input type="email" id="login-email" placeholder="Email" required>
            <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
            <button type="submit" class="submit">–í–æ–π—Ç–∏</button>
            <div class="extra"><a href="reset-password.html">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</a></div>
          </form>

          <!-- —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
          <form id="register-form">
            <input type="text" id="nick" placeholder="–ù–∏–∫" required>
            <input type="email" id="reg-email" placeholder="Email" required>
            <input type="password" id="reg-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
            <select id="gender" required>
              <option value="man">–ú—É–∂—á–∏–Ω–∞</option>
              <option value="woman">–ñ–µ–Ω—â–∏–Ω–∞</option>
              <option value="pair">–ü–∞—Ä–∞</option>
              <option value="trans_woman">–¢—Ä–∞–Ω—Å –ñ–µ–Ω—â–∏–Ω–∞</option>
              <option value="trans_man">–¢—Ä–∞–Ω—Å –ú—É–∂—á–∏–Ω–∞</option>
            </select>

            <input type="number" id="age" placeholder="–í–æ–∑—Ä–∞—Å—Ç" min="18" max="99">

            <div class="pair-ages" id="pair-ages">
              <input type="number" id="male_age" placeholder="–í–æ–∑—Ä–∞—Å—Ç –º—É–∂—á–∏–Ω—ã" min="18" max="99">
              <input type="number" id="female_age" placeholder="–í–æ–∑—Ä–∞—Å—Ç –∂–µ–Ω—â–∏–Ω—ã" min="18" max="99">
            </div>

            <input list="city-list" id="city" placeholder="–ì–æ—Ä–æ–¥" required>
            <datalist id="city-list"></datalist>

            <div class="checkboxes">
              <label><input type="checkbox" id="agree18"> –ú–Ω–µ –µ—Å—Ç—å 18 –ª–µ—Ç</label>
              <label><input type="checkbox" id="agreeRules"> –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ —Å–∞–π—Ç–∞</label>
            </div>

            <button type="submit" class="submit" id="registerBtn" disabled>–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
          </form>
        </div>
      </div>
    </main>
  </div>



  <script>
    // –º–æ–¥–∞–ª–∫–∞ 18+
    const ageModal=document.getElementById('ageModal');
    const authBox=document.getElementById('authBox');
    document.getElementById('yesBtn').onclick=()=>{
      ageModal.style.display='none';
      authBox.style.display='block';
      localStorage.setItem('age_confirmed','1');
    };
    document.getElementById('noBtn').onclick=()=>{
      alert('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏–º.');
      window.close();
    };
    if(localStorage.getItem('age_confirmed')==='1'){ageModal.style.display='none';authBox.style.display='block';}

    // –≤–∫–ª–∞–¥–∫–∏
    const tabLogin=document.getElementById('tab-login');
    const tabRegister=document.getElementById('tab-register');
    const loginForm=document.getElementById('login-form');
    const regForm=document.getElementById('register-form');
    tabLogin.onclick=()=>{loginForm.classList.add('active');regForm.classList.remove('active');tabLogin.classList.add('active');tabRegister.classList.remove('active');};
    tabRegister.onclick=()=>{loginForm.classList.remove('active');regForm.classList.add('active');tabRegister.classList.add('active');tabLogin.classList.remove('active');};

    // –ª–æ–≥–∏–∫–∞ –ø–∞—Ä—ã
    const genderSelect=document.getElementById('gender');
    const ageInput=document.getElementById('age');
    const pairAges=document.getElementById('pair-ages');
    genderSelect.onchange=()=>{
      if(genderSelect.value==='pair'){ageInput.style.display='none';pairAges.classList.add('active');}
      else{ageInput.style.display='block';pairAges.classList.remove('active');}
    };

    // –≥–æ—Ä–æ–¥–∞
    const cityInput=document.getElementById('city');
    const datalist=document.getElementById('city-list');
    const cities=["–ö–∏–µ–≤","–•–∞—Ä—å–∫–æ–≤","–û–¥–µ—Å—Å–∞","–î–Ω–µ–ø—Ä","–õ—å–≤–æ–≤","–ó–∞–ø–æ—Ä–æ–∂—å–µ","–í–∏–Ω–Ω–∏—Ü–∞","–ü–æ–ª—Ç–∞–≤–∞","–ß–µ—Ä–∫–∞—Å—Å—ã","–ß–µ—Ä–Ω–∏–≥–æ–≤","–ñ–∏—Ç–æ–º–∏—Ä","–°—É–º—ã","–•–µ—Ä—Å–æ–Ω","–ù–∏–∫–æ–ª–∞–µ–≤","–ò–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫–æ–≤—Å–∫"];
    cityInput.addEventListener('input',()=>{
      const val=cityInput.value.toLowerCase();
      datalist.innerHTML='';
      cities.filter(c=>c.toLowerCase().includes(val)).forEach(c=>{
        const opt=document.createElement('option');opt.value=c;datalist.appendChild(opt);
      });
    });

    // –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —á–µ–∫–±–æ–∫—Å—ã –≤—ã–±—Ä–∞–Ω—ã
    const agree18=document.getElementById('agree18');
    const agreeRules=document.getElementById('agreeRules');
    const regBtn=document.getElementById('registerBtn');
    function checkAgree(){regBtn.disabled=!(agree18.checked&&agreeRules.checked);}
    agree18.onchange=checkAgree;agreeRules.onchange=checkAgree;

    // –ª–æ–≥–∏–Ω
    const loginEmail=document.getElementById('login-email');
    const loginPassword=document.getElementById('login-password');
    loginForm.onsubmit=async e=>{
      e.preventDefault();
      const res=await fetch('http://localhost:3000/auth/login',{
        method:'POST',headers:{'Content-Type':'application/json'},
        body:JSON.stringify({email:loginEmail.value,password:loginPassword.value}),
        credentials:'include'
      });
      const data=await res.json();
      if(data.ok){
        if(data.status==="email_confirmed")window.location.href="profile-setup.html";
        else if(data.status==="profile_pending")window.location.href="pending.html";
        else if(data.status==="approved")window.location.href="feed.html";
        else alert("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å: "+data.status);
      }else alert("–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: "+(data.error||"–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è"));
    };

    // —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    regForm.onsubmit=async e=>{
      e.preventDefault();
      const body={
        email:document.getElementById('reg-email').value,
        password:document.getElementById('reg-password').value,
        nick:document.getElementById('nick').value,
        gender:genderSelect.value,
        city:cityInput.value,
        age:ageInput.value
      };
      if(genderSelect.value==='pair'){
        body.male_age=document.getElementById('male_age').value;
        body.female_age=document.getElementById('female_age').value;
      }
      const res=await fetch('http://localhost:3000/auth/register',{
        method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)
      });
      const data=await res.json();
      if(data.ok)window.location.href="check-email.html";
      else alert(JSON.stringify(data));
    };
  </script>
  <script src="components/layout.js"></script>

</body>
</html>
