<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>TwinSide ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- FAVICONS -->
<link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="assets/icons/apple-touch-icon.png">
<link rel="mask-icon" href="assets/icons/logo.svg" color="#7F3DF4">
<meta name="theme-color" content="#0B0B0D">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://twinside.com/">
<meta property="og:title" content="TwinSide ‚Äî –∑–∞–∫—Ä—ã—Ç–∞—è —Å–æ—Ü—Å–µ—Ç—å –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö">
<meta property="og:description" content="–ü—Ä–∏–≤–∞—Ç–Ω–æ–µ –∫–æ–º—å—é–Ω–∏—Ç–∏, –≥–¥–µ —Å—Ç–∏–ª—å, —Å—Ç—Ä–∞—Å—Ç—å –∏ –¥–æ–≤–µ—Ä–∏–µ —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è. –¢–æ–ª—å–∫–æ 18+, —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –ª—é–¥–∏.">
<meta property="og:image" content="https://twinside.com/assets/preview.jpg">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url" content="https://twinside.com/">
<meta name="twitter:title" content="TwinSide ‚Äî –∑–∞–∫—Ä—ã—Ç–∞—è —Å–æ—Ü—Å–µ—Ç—å –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö">
<meta name="twitter:description" content="–ü—Ä–∏–≤–∞—Ç–Ω–∞—è —Å–µ—Ç—å, –≥–¥–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å—Ç–∏–ª—å, –¥–æ–≤–µ—Ä–∏–µ –∏ —Å—Ç—Ä–∞—Å—Ç—å. –¢–æ–ª—å–∫–æ 18+.">
<meta name="twitter:image" content="https://twinside.com/assets/preview.jpg">

  <style>
    :root {
      --gold: #F2C94C;
      --violet: #7F3DF4;
      --black: #0B0B0D;
      --carbon: #141418;
      --text-hi: #fff;
      --text-med: #CFCFE2;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background: var(--black);
      color: var(--text-hi);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: url("https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?auto=format&fit=crop&w=1600&q=80") no-repeat center/cover;
      filter: brightness(0.35) blur(3px);
      z-index: -2;
    }
    body::after {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(180deg, rgba(11,11,13,0.6) 0%, rgba(11,11,13,0.95) 100%);
      z-index: -1;
    }
    .box {
      background: var(--carbon);
      padding: 30px;
      border-radius: 14px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 0 24px rgba(127,61,244,0.25);
      animation: fadeUp .6s ease;
    }
    h1 {
      text-align: center;
      color: var(--gold);
      font-size: 26px;
      margin-bottom: 20px;
    }
    label {
      font-size: 14px;
      color: var(--text-med);
      display: block;
      margin-bottom: 6px;
    }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 14px;
      border-radius: 8px;
      border: 1px solid #1C1C22;
      background: var(--black);
      color: var(--text-hi);
      font-size: 15px;
    }
    textarea { resize: none; height: 90px; }
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--violet);
      box-shadow: 0 0 8px rgba(127,61,244,0.5);
    }
    .choice-group, .tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 14px;
    }
    .choice-btn {
      background: #1C1C22;
      border: 1px solid #2A2A33;
      color: var(--text-med);
      padding: 8px 14px;
      border-radius: 20px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.25s ease;
    }
    .choice-btn.active {
      background: var(--violet);
      border-color: var(--violet);
      color: #fff;
      box-shadow: 0 0 10px rgba(127,61,244,0.5);
    }
    .preview {
      display: flex;
      gap: 10px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }
    .preview img {
      width: 90px;
      height: 90px;
      object-fit: cover;
      border-radius: 8px;
      border: 2px solid var(--violet);
    }
    button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 20px;
      font-weight: 600;
      background: var(--gold);
      color: var(--black);
      cursor: pointer;
      transition: all .25s ease;
      box-shadow: 0 0 18px rgba(242,201,76,0.35);
    }
    button:hover { filter: brightness(1.08); transform: translateY(-2px); }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .verify-hint {
      font-size: 14px;
      color: var(--text-med);
      background: rgba(127,61,244,0.15);
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 14px;
    }
    .success {
      text-align: center;
      font-size: 18px;
      color: var(--gold);
    }
  </style>
</head>
<body>
  <div class="box" id="form-box">
    <h1>–°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã</h1>
    <form id="profile-form">
      <label>–ê–≤–∞—Ç–∞—Ä</label>
      <input type="file" id="avatar" accept="image/*" required>
      <div class="preview" id="avatar-preview"></div>

      <label>–§–æ—Ç–æ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</label>
      <div class="verify-hint" id="verify-hint"></div>
      <input type="file" id="verify" accept="image/*" required>
      <div class="preview" id="verify-preview"></div>

      <label>–û —Å–µ–±–µ</label>
      <textarea id="about" maxlength="300" placeholder="–ö–æ—Ä–æ—Ç–∫–æ —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ..."></textarea>

      <label>–ö–æ–≥–æ –∏—â–µ—Ç–µ</label>
      <div class="choice-group" id="looking-group">
        <div class="choice-btn" data-value="woman">–ñ–µ–Ω—â–∏–Ω—É</div>
        <div class="choice-btn" data-value="man">–ú—É–∂—á–∏–Ω—É</div>
        <div class="choice-btn" data-value="pair">–ü–∞—Ä—É</div>
        <div class="choice-btn" data-value="trans_woman">–¢—Ä–∞–Ω—Å-–∂–µ–Ω—â–∏–Ω—É</div>
        <div class="choice-btn" data-value="trans_man">–¢—Ä–∞–Ω—Å-–º—É–∂—á–∏–Ω—É</div>
      </div>

      <label>–ò–Ω—Ç–µ—Ä–µ—Å—ã</label>
      <div class="tags" id="interests-group"></div>

      <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é</button>
    </form>
  </div>

  <div class="box success" id="success-box" style="display:none;">
    <h1>‚úÖ –ê–Ω–∫–µ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞</h1>
    <p>–í–∞—à–∞ –∞–Ω–∫–µ—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É.<br>
    –ú—ã —É–≤–µ–¥–æ–º–∏–º –≤–∞—Å –ø–æ email, –∫–æ–≥–¥–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è.</p>
    <button onclick="window.location.href='auth.html'">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
  </div>

  <script>
    // === –ü—Ä–µ–≤—å—é —Ñ–æ—Ç–æ ===
    function preview(input, previewBox) {
      previewBox.innerHTML = "";
      const file = input.files[0];
      if (!file) return;
      const img = document.createElement('img');
      img.src = URL.createObjectURL(file);
      previewBox.appendChild(img);
    }

    const avatarInput = document.getElementById('avatar');
    const verifyInput = document.getElementById('verify');
    const avatarPreview = document.getElementById('avatar-preview');
    const verifyPreview = document.getElementById('verify-preview');
    avatarInput.onchange = () => preview(avatarInput, avatarPreview);
    verifyInput.onchange = () => preview(verifyInput, verifyPreview);

    // === –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∞—Ç–∞ ===
    const hint = document.getElementById('verify-hint');
    function updateHint() {
      const now = new Date();
      const options = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
      const str = now.toLocaleString('ru-RU', options);
      hint.innerHTML = `üóìÔ∏è –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞ –ª–∏—Å—Ç–∏–∫–µ: <b>TwinSide ‚Äî ${str}</b>`;
    }
    updateHint();

    // === –ö–æ–≥–æ –∏—â–µ—Ç–µ ===
    const lookingGroup = document.getElementById('looking-group');
    lookingGroup.addEventListener('click', e => {
      if (!e.target.classList.contains('choice-btn')) return;
      e.target.classList.toggle('active');
    });

    // === –ò–Ω—Ç–µ—Ä–µ—Å—ã ===
    const interests = [
      "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è","–ú—É–∑—ã–∫–∞","–§–∏–ª—å–º—ã","–ô–æ–≥–∞","BDSM","–í–µ—á–µ—Ä–∏–Ω–∫–∏",
      "–§–ª–∏—Ä—Ç","–†–æ–º–∞–Ω—Ç–∏–∫–∞","–§–∏—Ç–Ω–µ—Å","–ò–≥—Ä—ã","–ú–∞—Å—Å–∞–∂","–†–æ–ª–µ–≤—ã–µ –∏–≥—Ä—ã",
      "–§–æ—Ç–æ","–ö–∞–ª—å—è–Ω","–ö–∏–Ω–æ","–ö–æ–∫—Ç–µ–π–ª–∏","–ü–ª—è–∂","–ö–æ—Å–ø–ª–µ–π"
    ];
    const interestsGroup = document.getElementById('interests-group');
    interests.forEach(i=>{
      const btn=document.createElement('div');
      btn.className='choice-btn';
      btn.textContent=i;
      btn.dataset.value=i;
      interestsGroup.appendChild(btn);
    });
    interestsGroup.addEventListener('click', e=>{
      if(!e.target.classList.contains('choice-btn'))return;
      e.target.classList.toggle('active');
    });

    // === –û—Ç–ø—Ä–∞–≤–∫–∞ ===
    const form=document.getElementById('profile-form');
    const formBox=document.getElementById('form-box');
    const successBox=document.getElementById('success-box');

    form.onsubmit=async(e)=>{
      e.preventDefault();
      const selectedLooking=[...lookingGroup.querySelectorAll('.choice-btn.active')].map(b=>b.dataset.value);
      const selectedInterests=[...interestsGroup.querySelectorAll('.choice-btn.active')].map(b=>b.dataset.value);

      const formData=new FormData();
      formData.append('avatar',avatarInput.files[0]);
      formData.append('verify_photo',verifyInput.files[0]);
      formData.append('about',document.getElementById('about').value);
      formData.append('looking_for',selectedLooking.join(','));
      formData.append('interests',selectedInterests.join(','));

      const res=await fetch('http://localhost:3000/profile/setup',{method:'POST',body:formData,credentials: 'include'});
      const data=await res.json();

      if(data.ok){
        formBox.style.display="none";
        successBox.style.display="block";
      } else {
        alert("–û—à–∏–±–∫–∞: "+(data.error||"–Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–Ω–∫–µ—Ç—É"));
      }
    };
  </script>
  <script src="components/layout.js"></script>

</body>
</html>
